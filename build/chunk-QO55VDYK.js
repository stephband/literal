/* Literal 
   0.9.0
   By Stephen Band */

var ce=Object.defineProperty;var ar=(t,e,r)=>e in t?ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var le=(t,e)=>{for(var r in e)ce(t,r,{get:e[r],enumerable:!0})};var w=(t,e,r)=>(ar(t,typeof e!="symbol"?e+"":e,r),r),kt=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var f=(t,e,r)=>(kt(t,e,"read from private field"),r?r.call(t):e.get(t)),x=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},y=(t,e,r,o)=>(kt(t,e,"write to private field"),o?o.call(t,r):e.set(t,r),r);var I=(t,e,r)=>(kt(t,e,"access private method"),r);function b(){}var Vt=!1;var G,pe=0;function fe(t,e){let r=0;for(;e[--r]&&e[r]!==t;);for(e[r]=t,r=-1;t[++r]&&t[r]!==e;);t[r]=e,Vt&&console.log("%cSignal%c connect%c "+t.constructor.name+"["+t.id+"] - "+e.constructor.name+"["+e.id+"]","color: #718893; font-weight: 300;","color: #3896BF; font-weight: 300;","color: #718893; font-weight: 300;")}function de(t){let e=-1,r;for(;r=t[++e];)t[e]=void 0,r.invalidate(t)}function me(t,e){let r=0;for(;t[--r];)if(t[r]===e)return!0;return!1}var c=class{static of(e){return new tt(e)}static from(e){if(e.then){let r=new tt;return e.then(o=>r.value=o),r}else if(e.pipe){let r=new tt;return e.pipe({push:o=>r.value=o}),r}else return new Mt(e)}static observe(e,r,o){return new et(e,r,o)}static evaluate(e,r){let o=G;G=e,Vt&&console.group("%cSignal%c evaluate%c "+G.constructor.name+"["+G.id+"]","color: #718893; font-weight: 300;","color: #3896BF; font-weight: 300;","color: #718893; font-weight: 300;");let n=r.apply(e);return G=o,n}static get evaluating(){return G}constructor(){Vt&&(this.id=++pe)}valueOf(){return this.value}toString(){return this.value+""}toJSON(){return this.value}},F,tt=class extends c{constructor(r){super();x(this,F,void 0);y(this,F,r)}get value(){return G&&fe(this,G),f(this,F)}set value(r){f(this,F)!==r&&(y(this,F,r),de(this))}};F=new WeakMap;var $,X,rt,Mt=class extends c{constructor(r){super();x(this,$,void 0);x(this,X,void 0);x(this,rt,void 0);r&&y(this,rt,r)}get value(){return G&&fe(this,G),f(this,$)?f(this,X):(y(this,X,c.evaluate(this,f(this,rt))),y(this,$,!0),f(this,X))}invalidate(r){if(!f(this,$)||r&&!me(this,r))return;y(this,$,!1);let o=0;for(;this[--o];)this[o]=void 0;de(this)}};$=new WeakMap,X=new WeakMap,rt=new WeakMap;var ur=Promise.resolve(),ot,W,nt,Pt,et=class{constructor(e,r,o){x(this,nt);x(this,ot,void 0);x(this,W,void 0);this.id=++pe,y(this,ot,e),y(this,W,r);let n=c.evaluate(this,I(this,nt,Pt));e.value!==o&&f(this,W).call(this,n)}invalidate(e){if(this.status==="done"||e&&!me(this,e))return;let r=0;for(;this[--r];)this[r]=void 0;ur.then(()=>f(this,W).call(this,c.evaluate(this,I(this,nt,Pt))))}stop(){return this.status==="done"?this:(this.status="done",this)}};ot=new WeakMap,W=new WeakMap,nt=new WeakSet,Pt=function(){return f(this,ot).value};var cr=Object.assign,lr=Object.defineProperties,pr=Object.isExtensible,fr=Object.prototype,H=Symbol("signal-data"),he={[H]:{}};function dr(t){return t&&pr(t)&&!Node.prototype.isPrototypeOf(t)&&(window.BaseAudioContext===void 0||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function ge(t,e,r){return t[e]||(t[e]=c.of(r))}function mr(t,e,r){let o=Object.getOwnPropertyDescriptor(r,e);return!(o?o.writable||o.set:r[e]===void 0)||!c.evaluating?r[e]:ge(t,e,r[e]).value}function hr(t){return d(t)&&t[H]}function we(t){this.signals={},this.object=t,this.data=new Proxy(t,this),he[H].value=this,lr(t,he)}cr(we.prototype,{get:function(e,r,o){if(typeof r=="symbol"||r==="__proto__")return e[r];let n=mr(this.signals,r,e);return fr.hasOwnProperty.call(e,r)&&d(n)||n},set:function(e,r,o,n){if(typeof r=="symbol"||r==="__proto__")return e[r]=o,!0;let i=d.objectOf(o);if(e[r]===o||e[r]===i)return!0;let s=e.length;return e[r]=i,this.signals[r]&&(this.signals[r].value=e[r]),r!=="length"&&e.length!==s&&this.signals.length&&(this.signals.length.value=e.length),!0},deleteProperty:function(t,e){return delete t[e],typeof e!="symbol"&&e!=="__proto__"&&this.signals[e]&&(this.signals[e].value=t[e]),!0}});function d(t,e){return t?t[H]?t[H].data:e||dr(t)?new we(t).data:void 0:void 0}d.of=d;d.signal=function(t,e){let r=hr(e);return r&&ge(r.signals,t,r.object[t])};d.objectOf=function(t){return t&&t[H]?t[H].object:t};var _={updateEvent:!1};var Wt={};le(Wt,{Data:()=>d,Signal:()=>c,arg:()=>it,assign:()=>Dr,cache:()=>A,capture:()=>ve,ceil:()=>Gr,choose:()=>j,entries:()=>Tr,exec:()=>ye,floor:()=>Sr,id:()=>p,isDefined:()=>J,keys:()=>Br,last:()=>$t,matches:()=>Ee,noop:()=>b,nothing:()=>Ne,overload:()=>l,remove:()=>De,round:()=>Ur,set:()=>It,sum:()=>Xt,values:()=>Or});function it(t){return function(){return arguments[t]}}function A(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var n=t(o);return e.set(o,n),n}}var gr=Array.prototype;function wr(t,e){return typeof t=="function"?t.apply(null,e):t}function xe(t,e,r){r=r||t.length;var o=r===1?e?t:A(t):A(function(n){return xe(function(){var i=[n];return i.push.apply(i,arguments),t.apply(null,i)},e,r-1)});return function n(i){return arguments.length===0?n:arguments.length===1?o(i):arguments.length>=r?t.apply(null,arguments):wr(o(i),gr.slice.call(arguments,1))}}var h=xe;function Ft(t,e,r){let o;typeof r!="string"&&r.input!==void 0&&r.index!==void 0&&(o=r,r=o.input.slice(r.index+r[0].length+(r.consumed||0)));let n=t.exec(r);if(!n)return;let i=e(n);return o&&(o.consumed=(o.consumed||0)+n.index+n[0].length+(n.consumed||0)),i}var ye=h(Ft,!0);function xr(t,e,r){throw r.input!==void 0&&r.index!==void 0&&(r=r.input),new Error('Cannot parse string "'+(r.length>128?r.length.slice(0,128)+"â€¦":r)+'"')}function yr(t,e,r){let o=-1;for(;++o<r.length;)e=r[o]!==void 0&&t[o]?t[o](e,r):e;return t.done?t.done(e,r):t.close?t.close(e,r):e}function vr(t,e,r,o){let n=Ft(t,i=>yr(e,r,i),o);return n===void 0?e.catch?e.catch(r,o):xr(t,e,o):n}var ve=h(vr,!0);function j(t){return function(r,...o){var n=t[r]||t.default;return n&&n.apply(this,o)}}function p(t){return t}function J(t){return!!t||t!=null&&!Number.isNaN(t)}function $t(t){if(typeof t.length=="number")return t[t.length-1]}function Er(t,e){let r;for(r in t)if(t[r]!==e[r])return!1;return!0}var Ee=h(Er,!0);function D(){return this}var be=Object.create,br=Object.freeze,Ne=br(be(be(Object.prototype,{at:{value:b},shift:{value:b},push:{value:b},forEach:{value:b},join:{value:function(){return""}},every:{value:function(){return!0}},filter:{value:D},find:{value:b},findIndex:{value:function(){return-1}},flat:{value:D},flatMap:{value:D},includes:{value:function(){return!1}},indexOf:{value:function(){return-1}},map:{value:D},reduce:{value:it(1)},sort:{value:D},each:{value:D},pipe:{value:p},start:{value:D},stop:{value:D},done:{value:D},valueOf:{value:function(){return null}}}),{length:{value:0}}));function l(t,e){return function(){let o=t.apply(this,arguments),n=e[o]||e.default;if(!n)throw new Error('overload() no function defined for key "'+o+'"');return n.apply(this,arguments)}}function Ht(t,e){t.remove&&t.remove(e);let r;for(;(r=t.indexOf(e))!==-1;)t.splice(r,1);return t}var De=h(Ht,!0);function Nr(t,e,r){let o=t.replace(/([^.]+)\./g,(n,i)=>(e=e[i],""));return e[o]=r}var It=h(Nr,!0);function Xt(t,e){return e+t}var Dr=Object.assign,Tr=Object.entries,Br=Object.keys,Or=Object.values,Gr=Math.ceil,Sr=Math.floor,Ur=(t,e=1)=>Math.round(t/e)*e;var zt={};le(zt,{body:()=>oo,create:()=>S,decode:()=>st,frame:()=>no,getValue:()=>ft,identify:()=>at,isTextNode:()=>Jt,parse:()=>ut,request:()=>vt,root:()=>ro,toNodeType:()=>ct,translate:()=>io,trigger:()=>K});var Rr=l(p,{is:b,tag:b,data:function(t,e,r){for(t in r)r[t]===void 0&&delete r[t];Object.assign(e.dataset,r)},dataset:function(t,e,r){Object.assign(e.dataset,r)},html:function(t,e,r){e.innerHTML=r},text:function(t,e,r){e.textContent=r},children:function(t,e,r){e.innerHTML="",e.append.apply(e,r)},points:T,cx:T,cy:T,r:T,x:T,y:T,dx:T,dy:T,transform:T,preserveAspectRatio:T,viewBox:T,default:function(t,e,r){t in e?e[t]=r:e.setAttribute(t,r)}});function T(t,e,r){e.setAttribute(t,r)}function Ar(t,e){for(var r=Object.keys(e),o=r.length;o--;)Rr(r[o],t,e[r[o]]);return t}var xt=h(Ar,!0);var _t="http://www.w3.org/2000/svg",Te=document.createElement("template"),jt=(t,e)=>e&&typeof e;function Be(t,e=""){let r=document.createRange();return r.selectNode(t),r.createContextualFragment(e)}var E=l(jt,{string:function(t,e){let r=document.createElementNS(_t,t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElementNS(_t,t);return typeof e.length=="number"?r.append.apply(r,e):xt(r,e),r},default:t=>document.createElementNS(_t,t)}),Cr=l(jt,{string:function(t,e){let r=document.createElement(t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElement(t);return typeof e.length=="number"?r.append.apply(r,e):xt(r,e),r},default:t=>document.createElement(t)}),Lr=l(p,{comment:function(t,e){return document.createComment(e||"")},fragment:l(jt,{string:function(t,e,r){return r?Be(r,e):(Te.innerHTML=e,Te.content.cloneNode(!0))},object:function(t,e,r){let o=r?Be(r):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):xt(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:E,ellipse:E,g:E,glyph:E,image:E,line:E,rect:E,use:E,path:E,pattern:E,polygon:E,polyline:E,svg:E,tspan:E,default:Cr}),S=Lr;var Oe=document.createElement("textarea");function st(t){return Oe.innerHTML=t,Oe.value}function at(t,e="id-"){var r=t.id;if(!r){do r=e+Math.ceil(Math.random()*1e6);while(document.getElementById(r));t.id=r}return r}function Jt(t){return t.nodeType===3}var qr={xml:"application/xml",html:"text/html",svg:"image/svg+xml"};function ut(t,e){if(e){var r=qr[t.toLowerCase()]||t,o;try{o=new window.DOMParser().parseFromString(e,r)}catch{return}if(!o||o.getElementsByTagName("parsererror").length)throw new Error("Invalid "+t.toUpperCase()+": "+e);return o}}function Ge(t){return ut("html",t)}function Se(t){return ut("svg",t)}var U=Object.assign,z={headers:function(t){return{}},body:p},kr=j({"application/x-www-form-urlencoded":function(t){return U(t,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})},"application/json":function(t){return U(t,{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"XMLHttpRequest"})},"multipart/form-data":function(t){return U(t,{"Content-Type":"multipart/form-data","X-Requested-With":"XMLHttpRequest"})},"audio/wav":function(t){return U(t,{"Content-Type":"audio/wav","X-Requested-With":"XMLHttpRequest"})},"image/png":function(t){return U(t,{"Content-Type":"image/png","X-Requested-With":"XMLHttpRequest"})},"image/jpg":function(t){return U(t,{"Content-Type":"image/jpg","X-Requested-With":"XMLHttpRequest"})},"image/jpeg":function(t){return U(t,{"Content-Type":"image/jpeg","X-Requested-With":"XMLHttpRequest"})},default:function(t){return U(t,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})}}),Vr=j({"application/json":function(t){return t.get?Mr(t):JSON.stringify(t)},"application/x-www-form-urlencoded":function(t){return t.get?Re(t):Ae(t)},"multipart/form-data":function(t){return t.get?t:Pr(t)},default:p});function Mr(t){return JSON.stringify(Array.from(t.entries()).reduce(function(e,r){return e[r[0]]=r[1],e},{}))}function Re(t){return new URLSearchParams(t).toString()}function Ae(t){return Object.keys(t).reduce((e,r)=>(e.append(r,t[r]),e),new URLSearchParams)}function Pr(t){throw new Error("TODO: dataToFormData(data)")}function Fr(t,e){return e instanceof FormData?t+"?"+Re(e):t+"?"+Ae(e)}function $r(t,e,r,o){let n=typeof r=="string"?r:r&&r["Content-Type"]||"application/json",i=kr(n,U(z.headers&&e?z.headers(e):{},typeof r=="string"?{}:r)),s={method:t,mode:"cors",headers:i,credentials:"same-origin",signal:o&&o.signal};return t!=="GET"&&(s.body=Vr(n,z.body?z.body(e):e)),s}function yt(t){return t.blob()}function Hr(t){return t.json().catch(e=>{throw new Error("Cannot parse JSON "+t.url+". "+e.message)})}function Ue(t){return t.formData()}function Ir(t){return t.text()}function Xr(t){return t.text().then(e=>/^\s*<!DOCTYPE html>/.test(e)?Ge(e):S("fragment",e))}function Wr(t){return t.text().then(e=>/^\s*<\?xml/.test(e)?Se(e):(console.warn("Untested SVG fragment parsing in request.js!"),S("fragment",e)))}var _r={"text/plain":Ir,"text/html":Xr,"image/svg+xml":Wr,"application/json":Hr,"multipart/form-data":Ue,"application/x-www-form-urlencoded":Ue,audio:yt,"audio/wav":yt,"audio/m4a":yt,"application/zip":yt};function jr(t){if(z.onresponse&&(t=z.onresponse(t)),!t.ok)throw new Error(t.statusText+"");let e=t.headers.get("Content-Type");if(!e)return;let r=e.replace(/\;.*$/,"");return _r[r](t)}function vt(t="GET",e,r={},o="application/json"){t=t.toUpperCase(),t==="GET"&&r&&(e=Fr(e,r));let n=$r(t,r,o,arguments[4]);return fetch(e,n).then(jr)}function Et(t){return vt("GET",t)}var Jr={1:"element",3:"text",8:"comment",9:"document",10:"doctype",11:"fragment"};function ct(t){return Jr[t.nodeType]}var zr=Object.assign,lt={bubbles:!0,cancelable:!0};function Kr(t,e){let r=lt,o,n,i,s,a,u;return typeof t=="object"?({type:t,detail:n,bubbles:i,cancelable:s,composed:a,...o}=t,u=zr(new CustomEvent(t,{detail:n,bubbles:i||lt.bubbles,cancelable:s||lt.cancelable,composed:a||lt.composed}),o)):u=new CustomEvent(t,lt),e.dispatchEvent(u)}var K=h(Kr,!0);function Qr(t,e){return e[t]}var B=h(Qr,!0);var Ce=t=>typeof t;var Yr=/\s*(\([\w,\s]*\))/,Zr=/function(?:\s+\w+)?\s*(\([\w,\s]*\))/,Le=l(Ce,{boolean:p,function:t=>t.prototype?(t.name||"function")+(Zr.exec(t.toString())||[])[1]:(Yr.exec(t.toString())||[])[1]+" â‡’ {â€¦}",number:t=>Number.isNaN(t)?"":Number.isFinite(t)?t+"":t<0?"-âˆž":"âˆž",string:p,symbol:t=>t.toString(),undefined:t=>"",object:l(t=>t&&t.constructor.name,{Array:t=>t.map(Le).join(""),RegExp:t=>"/"+t.source+"/",Stream:()=>"",null:()=>"",default:t=>JSON.stringify(t,null,2)}),default:JSON.stringify}),C=Le;var ke=Array.prototype,Q=Symbol("value"),to={"select-one":!0,"select-multiple":!0,checkbox:!0,radio:!0,undefined:!0};function pt(t){return Q in t?t[Q]:"value"in t?t.value:t.getAttribute("value")||void 0}var ft=l(B("type"),{"select-one":t=>t.selectedIndex>-1?pt(t.options[t.selectedIndex]):void 0,"select-multiple":t=>ke.filter.call(t.options,B("selected")).map(pt),checkbox:pt,radio:pt,number:t=>Number(t.value),range:t=>Number(t.value),default:t=>t.value}),eo={number:"number",range:"number"};function qe(t,e){if(document.activeElement===t)return 0;let r=to[t.type];if(r&&Q in t&&t[Q]===e)return;let o=eo[t.type];if(o&&typeof e!==o)return;r&&(t[Q]=e);let n=C(e);n!==t.value&&("value"in t?t.value=n:t.setAttribute("value",n),_.updateEvent&&K(_.updateEvent,t))}var Ve=l(B("type"),{"select-one":(t,e)=>{if(typeof e=="string"||typeof e=="number")return qe(t,e);let r=ke.find.call(t.options,o=>e===pt(o));return r&&!r.selected?(r.selected=!0,1):0},default:qe});function Me(t){delete t[Q]}var ro=document.documentElement,oo=document.body,no=window.requestAnimationFrame;function io(t){return window.translations&&window.translations[t]||t}var bt=Object.assign({},Wt,zt);var so='<a class="literal-link" href="https://stephen.band/literal/literal-html/">literal</literal>';function ao(t){if(typeof t=="object"&&t.template)return"<strong>"+t.id+"</strong> "+t.template+" <small>&gt; "+t.path+'</small> <!--strong class="literal-count">'+t.count+"</strong-->";if(typeof t=="object"&&t.message)return'<code class="white-fg">'+t.message+"</code>";if(typeof t=="object")return"<code><strong>"+t.constructor.name+"</strong> "+JSON.stringify(t)+"</code>"}function uo(t,e){let r=document.createElement("pre"),o="";return r.setAttribute("class","literal-error"),r.innerHTML="<strong>"+e.constructor.name+"</strong><code>"+e.message+"</code>",console.error(e),r}function co(t,e){let r=t.path+(typeof t.name=="string"?">"+t.name:""),o=0,n="";for(;arguments[++o]!==void 0;)n+=ao(arguments[o]);return S("pre",{class:"literal-print",html:"#"+t.templateId+" <small>"+(r?"&gt; "+r.replace(/>/g," &gt "):"")+'</small><span class="literal-count">'+t.renderCount+"</span>"+n+so})}function Kt(t,e){return e instanceof Error?uo(t,e):co(t,e)}var lo=Object.entries,Nt={};function po(t,[e,r]){let o=new URL(e,window.location);return Nt[o]=new URL(r,window.location),Nt}function Hi(t){lo(t).reduce(po,Nt)}function Pe(t){let e=new URL(t,window.location);return Nt[e]||e}function Dt(t){var e={};return function(o){return o in e?e[o]:e[o]=t(o)}}var fo=/\.([\w-]+)(?:#|\?|$)/,mo=[],ho=l(t=>(fo.exec(t.pathname)||mo)[1],{js:Dt(t=>{let e=t.origin+t.pathname+t.search,r=t.hash.slice(1)||"default";return import(e).then(B(r))}),default:Dt(Et)});function Qt(t){let e=Pe(t);return ho(e)}function go(t){let e=t[0];return/^\w/.test(e)}function Yt(t={},e,r,o){let n=Object.entries(t).filter(go),i=n.map(B(0)),s=n.map(B(1));return o?new Function(...i,"return ("+e+") => {"+(r||"")+"}").apply(o,s):new Function(...i,"return function("+e+"){"+(r||"")+"}").apply(null,s)}var Tt=">";var Fe="";var Zt={};function dt(t,e,r,o={},n){let i=`
`+Fe+(o.nostrict?"with(data) ":'"use strict";')+"return this.compose`"+t+"`;\n";return Zt[i]?Zt[i]:Zt[i]=Yt(e,r,i)}var R={"accept-charset":"acceptCharset",accesskey:"accessKey",cellpadding:"cellPadding",cellspacing:"cellSpacing",class:"classList",codebase:"codeBase",colspan:"colSpan",datetime:"dateTime",for:"htmlFor",form:null,formaction:"formAction",formenctype:"formEnctype",formmethod:"formMethod",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",httpequiv:"httpEquiv",longdesc:"longDesc",maxlength:"maxLength",minlength:"minLength",nohref:"noHref",noresize:"noResize",noshade:"noShade",nowrap:"noWrap",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",tfoot:"tFoot",thead:"tHead",usemap:"useMap",valign:"vAlign",valuetype:"valueType"};var Y=[],Bt;function wo(t){let e,r,o=-1;for(;Y[++o];)Y[o].update();Bt=void 0,Y.length=0}function $e(t){return Bt===void 0&&(Bt=requestAnimationFrame(wo)),Y.push(t),Bt}function He(t){let e=Y.indexOf(t);return e>0&&Y.splice(e,1),t}var Ot=Symbol("stopables"),St={attribute:0,property:0,token:0,text:0,remove:0,add:0};function Ie(t){t.stop()}function xo(t){t.cancelled=!0}function Xe(t){t&&(t.forEach(xo),t.length=0)}function Gt(t,e,r,o,n,i=!1){if(n&&typeof n=="object"){let s=d.objectOf(n);if(typeof s.then=="function"){let a=t.promises||(t.promises=[]);r[o]="",s.then(u=>{if(!s.cancelled)return Ht(a,s),Gt(t,e,r,o,u,!0)}),a.push(s);return}if(typeof s.pipe=="function"){let a=t.streams||(t.streams=[]);r[o]="";let u=!1;s.pipe({push:m=>Gt(t,e,r,o,m,u)}),u=!0,a.push(s);return}if(typeof s.length=="number"){let a=s.length;for(;a--;)Gt(t,e,s,a,s[a])}}r[o]=n,i&&t.render.apply(t,e)}var mt,N=class{constructor(e,r,o,n,i,s){x(this,mt,void 0);let a=this.constructor.parameterNames;y(this,mt,e),this.literal=r,this.element=n,this.status="idle",this.parameters=a.map(u=>o[u]),this.renderCount=0}evaluate(){let e=f(this,mt).value;if(!e)return;let r=this.parameters;return r[0]=d.of(e),r[1]=d.objectOf(e),r[2]=this.element,++this.renderCount,this.literal.apply(this,r)}invalidate(){if(this.status!=="done"){if(this.status==="cued"){console.warn(this.constructor.name+" "+this.templateId+" "+this.path+" already cued");return}$e(this),this.status="cued"}}update(){return Xe(this.promises),c.evaluate(this,this.evaluate),this.status="idle",this}compose(e){this.singleExpression===void 0&&(this.singleExpression=e.length===2&&!/\S/.test(e[0])&&!/\S/.test(e[1]));let r=0;for(;e[++r]!==void 0;)Gt(this,arguments,arguments,r,arguments[r]);return this.render.apply(this,arguments)}stop(){if(this.status==="done")return this;this.status==="cued"&&He(this),et.prototype.stop.apply(this),Xe(this.promises),this.streams&&this.streams.forEach(Ie);let e=this[Ot];return e&&(this[Ot]=void 0,e.forEach(Ie)),this}done(e){return this.status==="done"?(e.stop(),this):((this[Ot]||(this[Ot]=[])).push(e),this)}};mt=new WeakMap,w(N,"parameterNames",["data","DATA","element","host","shadow"]);var yo=Object.getOwnPropertyDescriptor,vo=Object.getPrototypeOf;function We(t,e){let r=yo(e,t);return r?r.set||r.writable:We(t,vo(e))}function Eo(t,e,r){if(t[e]===r)return 0;t[e]=r}function bo(t,e,r){if(r===t.getAttribute(e))return 0;t.setAttribute(e,r)}function te(t){let e=t[0],r=0,o=e[r];for(;e[++r]!==void 0;)o+=C(t[r]),o+=e[r]}var g=class extends N{constructor(e,r,o,n,i,s){super(e,r,o,n,i,s),this.name=i,this.property=i in R?R[i]:i,this.writable=i in R?!!R[i]:i in n&&We(i,n)}evaluate(){if(!1)try{}catch(e){}return super.evaluate()}render(e){let r=this.singleExpression?arguments[1]:te(arguments);return this.writable?Eo(this.element,this.property,r):bo(this.element,this.name,r)}};w(g,"parameterNames",N.parameterNames);function No(t,e,r){t[e]!==!!r&&(t[e]=!!r,window.DEUBG&&++St.property)}function Do(t,e,r){if(t.getAttribute(e)!==null){if(r)return;t.removeAttribute(e),window.DEUBG&&++St.attribute;return}r&&t.setAttribute(e,e)}function ee(t){let e=t[0],r=0;if(/\S/.test(e[r]))return!0;for(;e[++r]!==void 0;)if(t[r]||/\S/.test(e[r]))return!0;return!1}var L=class extends g{constructor(e,r,o,n,i,s){super(e,r,o,n,i,s),c.evaluate(this,this.evaluate)}render(e){let r=this.singleExpression?arguments[1]:ee(arguments);return this.writable?No(this.element,this.property,r):Do(this.element,this.name,r)}};w(L,"parameterNames",g.parameterNames);function To(t,e,r){return typeof e.set=="function"?e.set(t,r):e[t]=r}var Bo=h(To,!0);function Oo(t){return""+t}function Go(t,e,r){let o=typeof e=="boolean"?e:r?t.type==="checkbox"&&e&&e.map?e.map(Oo).includes(ft(t)):e+""===t.value:!!e;o!==t.checked&&(t.checked=o,_.updateEvent&&K(_.updateEvent,node))}var q=class extends g{constructor(e,r,o,n,i,s){super(e,r,o,n,"checked",s),this.hasValue=J(n.getAttribute("value")),c.evaluate(this,this.evaluate)}render(e){let r=this.singleExpression?!!arguments[1]:ee(arguments);return Go(this.element,r,this.hasValue)}};w(q,"parameterNames",["data","DATA","element","host","shadow","bind"]);var ha=Array.prototype,So=[];function Uo(t,e,r,o=0){let n=e.length;for(;n--;)r.includes(e[n])&&e.splice(n,1);return e.length&&t.remove.apply(t,e),r.length&&t.add.apply(t,r),o}var k=class extends g{constructor(e,r,o,n,i,s){super(e,r,o,n,i,s),this.list=n[this.property],this.tokens=So,c.evaluate(this,this.evaluate)}render(e){if(this.renderCount===1){let i=e.join(" ").trim();if(i){let s=i.split(/\s+/);this.list.add.apply(this.list,s)}}let r=0,o="";for(;e[++r]!==void 0;)o+=" "+C(arguments[r]);let n=o.trim().split(/\s+/);Uo(this.list,this.tokens,n),this.tokens=n}};w(k,"parameterNames",g.parameterNames);var Ro=l(B("type"),{number:Number,range:Number,default:p}),V=class extends g{constructor(e,r,o,n,i,s){super(e,r,o,n,"value",s),c.evaluate(this,this.evaluate)}render(e){let r=Ro(this.element.type,this.singleExpression?arguments[1]:te(arguments));return Ve(this.element,r)}stop(){return Me(this.element),super.stop()}};w(V,"parameterNames",["data","DATA","element","host","shadow","bind"]);function _e(t){return t.nodeType===1}function re(t){return t.nodeType===3}function je(t){return t.nodeType===8}function Je(t){return t.nodeType===11}function oe(t){let e=t.slice(1),r=document.getElementById(e);if(!r)throw new Error("Template "+t+" not found");return r}var ze=A(function(e){return Et(e).then(r=>{let o=new URL(e,window.location),n=o.hash?r.querySelector(o.hash):r;return{id:e,content:n.content||n}})});function Ke(t,e,r,o,n){let i=new O(t,r,o,n);return e.each(s=>i.push(s)),i.done(e),i}function ne(t,e,r,o,n){let i=d.objectOf(e);if(/^#/.test(t)){let u=oe(t),m=typeof i=="string"?Qt(i):i&&i.then?i:null;return m?m.then(wt=>new O(u,r,o,wt,n)):i&&i.pipe?Ke(u,i,r,o,n):new O(u,r,o,i,n)}let s=ze(t),a=typeof i=="string"?Qt(i):(i&&i.then,i);return i&&i.pipe?s.then(u=>Ke(u,e,r,o,n)):Promise.all([s,a]).then(([u,m])=>new O(u,r,o,m,n))}function ie(t,e){if(t===e){e.remove();return}let r=new Range;r.setStartBefore(t),r.setEndBefore(e),r.deleteContents()}var Ao=Object.assign;function Qe(t){t&&typeof t=="object"&&t.stop&&t.stop()}function Ye(t,e){let r=t.nodeValue;r?r!==e&&(t.nodeValue=e):e&&(t.nodeValue=e)}function Ze(t){return t.content?Ze(t.content):t}var M=class extends N{constructor(e,r,o,n,i,s){let a=Ao({},o,{include:(...u)=>this.include(...u),print:(...u)=>Kt(this,...u)});super(e,r,a,n,i,s),this.contents=[i],c.evaluate(this,this.evaluate)}get firstNode(){return this.contents[0].firstNode?this.contents[0].firstNode:this.contents[0]}get lastNode(){return this.contents[this.contents.length-1]}include(e){return arguments.length===1?r=>this.include(e,r):ne(e,arguments[1],this.element,this.parameters)}evaluate(){if(!1)try{}catch(e){}return super.evaluate()}render(e){let r=this.contents,o=-1,n=r[r.length-1],i=-1,s="",a;for(;++i<e.length-1;){if(s+=e[i],a=arguments[i+1],!(a instanceof O)&&!(a instanceof Node)){s+=C(a);continue}if(s){if(++o<r.length-1&&re(r[o]))Ye(r[o],s);else{let u=document.createTextNode(s);r[o].before(u),r.splice(o,0,u)}s=""}if(a!==r[++o]){if(--o,a instanceof O){r[++o].before(Ze(a)),r.splice(o,0,a);continue}if(Je(a)){console.log("TODO");continue}if(re(a)||_e(a)||je(a)){r[++o].before(a),r.splice(o,0,a);continue}}}if(s+=e[i],r[++o]!==n){let u=r[o].firstNode||r[o];ie(u,n),r.splice(o,r.length-o-1).forEach(Qe)}Ye(n,s)}stop(){return this.contents.forEach(Qe),this.contents.length=0,super.stop.apply(this)}};w(M,"parameterNames",["data","DATA","element","host","shadow","include","print"]);N.create=function(e,r,o,n,i,s){let a=typeof i=="string"&&(R[i]||i);return a?a==="value"?new V(e,r,o,n,i,s):a==="checked"?new q(e,r,o,n,i,s):typeof n[a]=="boolean"?new L(e,r,o,n,i,s):typeof n[a]=="object"&&n[a].add&&n[a].remove?new k(e,r,o,n,i,s):new g(e,r,o,n,i,s):new M(e,r,o,n,i,s)};var Ut=N;var Co=Array.prototype;function Rt(t){return Co.indexOf.apply(t.parentNode.childNodes,arguments)}var Lo=/\$\{/;function ht(t){return t&&Lo.test(t)}function At(t,e,r,o,n,i){let s=r.localName,a=r.value;if(!ht(a))return;let u={source:a,path:o,name:s},m=R[s]||s,wt=m==="value"?V:m==="checked"?q:typeof e[m]=="boolean"?L:typeof e[m]=="object"&&e[m].add&&e[m].remove?k:g;if(!1)try{}catch($o){}else u.literal=dt(a,bt,wt.parameterNames.join(", "),n);return t.push(u),e.removeAttribute(s),t}function ae(t,e,r,o,n){let i=Array.from(e.childNodes);if(i){let s=-1;for(;i[++s];){if(i[s].content){let a=i[s],u=a.content;u.childNodes.length&&(i.splice(s,1,...u.childNodes),a.before(u),a.remove())}tr(t,i[s],r,o,n)}}return t}function se(t,e,r,o,n){let i=Array.from(e.attributes),s=-1,a;for(;a=i[++s];)At(t,e,a,r,o,n);return t}var qo=l((t,e)=>e.tagName.toLowerCase(),{defs:p,template:p,script:se,textarea:(t,e,r,o,n)=>(se(t,e,r,o,n),At(t,e,{localName:"value",value:e.textContent},r,o,n),e.textContent="",t),default:(t,e,r,o,n)=>(ae(t,e,r,o,n),se(t,e,r,o,n),t)}),tr=l((t,e)=>ct(e),{comment:p,doctype:p,document:ae,fragment:ae,element:(t,e,r,o,n)=>(qo(t,e,(r?r+Tt:"")+Rt(e),o,n),t),text:(t,e,r,o,n)=>{let i=e.nodeValue;if(!ht(i))return t;let s=st(i),a={source:s,path:r,name:Rt(e)};if(!1)try{}catch(sr){}else a.literal=dt(s,bt,M.parameterNames.join(", "),o);return t.push(a),t}}),er=tr;function ue(t,e,r){return er([],t,"",e,r)}var rr={};var ko={};function Vo(t,e){return t.childNodes[e]}function Mo(t,e){return t.split(Tt).reduce(Vo,e)}function Po(t,e,r){let o=t.content||S("fragment",t.childNodes,t),n;return n=ue(o,r),{content:o,targets:n}}function or(t,e,r){if(t===e){r.prepend(e);return}let o=new Range;o.setStartBefore(t),o.setEndAfter(e);let n=o.extractContents();r.appendChild(n)}var Z,gt,P,Ct,nr,Lt,ir,qt=class qt{constructor(e,r=e.parentElement,o={},n,i=ko){x(this,Ct);x(this,Lt);x(this,Z,void 0);x(this,gt,void 0);x(this,P,void 0);w(this,"stop",Ut.prototype.stop);w(this,"done",Ut.prototype.done);let s=at(e,"literal-"),a=rr[s]||(rr[s]=Po(e,s,{nostrict:i.nostrict||e.hasAttribute&&e.hasAttribute("nostrict")})),u=a.content.cloneNode(!0),m=u.childNodes;y(this,P,c.of(d.of(n))),y(this,Z,m[0]),y(this,gt,m[m.length-1]),this.content=u,this.element=r,this.parameters=o,this.contents=a.targets.map(I(this,Ct,nr),this).map(I(this,Lt,ir),this)}static isTemplate(e){return e instanceof qt}static of(e){let r=S("template",e);return new qt(r)}get firstNode(){let e=this.contents[0];return f(this,Z)===e.lastNode?e.firstNode:f(this,Z)}get lastNode(){return f(this,gt)}push(e){if(this.status==="done")throw new Error("Renderer is done, cannot .push() data");if(f(this,P)!==e)return f(this,P)===null&&e!==null&&this.lastNode.before(this.content),f(this,P).value=d.of(e),e===null&&(this.firstNode!==this.lastNode&&or(this.firstNode,this.lastNode.previousSibling,this.content),this.lastNode.textContent=""),this.content}before(){let e=this.firstNode,r=this.lastNode;if(this.content.lastChild===r)throw new Error("Illegal LiteralTemplate.before() â€“ template is not in the DOM");return this.content.firstChild===e?r.before.apply(r,arguments):e.before.apply(e,arguments)}remove(){let e=this.firstNode,r=this.lastNode;if(this.content.lastChild!==r){if(this.content.firstChild===e){this.content.appendChild(r);return}or(e,r,this.content)}}};Z=new WeakMap,gt=new WeakMap,P=new WeakMap,Ct=new WeakSet,nr=function(e){let{path:r,name:o,literal:n,message:i,template:s}=e,a=r?Mo(r,this.content):this.element,u=typeof o=="number"?r?a.childNodes[o]:this.content.childNodes[o]:o;return[f(this,P),n,this.parameters,a,u,e]},Lt=new WeakSet,ir=function(e){let r=Ut.create(...e);return this.done(r),r};var O=qt;export{l as a,b,c,d,A as e,S as f,Ht as g,it as h,ve as i,$t as j,Ne as k,_ as l,bt as m,oe as n,Hi as o,Pe as p,Qt as q,Zt as r,O as s};
